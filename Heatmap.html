<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <title>Heatmap Example</title>
    <link rel="stylesheet" href="/styles/Heatmap.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            background-color: rgb(55, 55, 55);
            font-family: Arial, sans-serif;
            color: white;
        }

        .heatmap-cell {
            stroke: #000;
            stroke-width: 1;
        }

        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.9);
            color: #000;
            padding: 5px;
            border-radius: 3px;
            pointer-events: none;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">World of Warcraft |</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup"
            aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
                <a class="nav-link" aria-current="page" href="index.html"><i class="fa-solid fa-house fa-lg"></i> Home</a>
                <a class="nav-link" aria="page" href="BubbleChart.html"><i class="fa-solid fa-chart-line fa-lg"></i> Bubble Chart</a>
                <a class="nav-link" aria="page" href="HexbinDensity.html"><i class="fa-solid fa-chart-bar fa-lg"></i> Weapon Density</a>
                <a class="nav-link active" aria="page" href="#"><i class="fa-solid fa-chart-column fa-lg"></i> Heatmap</a>
                <a class="nav-link" aria="page" href="react.html"><i class="fa-solid fa-database fa-lg"></i> Data Table</a>
    
            </div>
          </div>
        </div>
      </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div id="filter">
                    <label>
                        <input type="checkbox" id="selectAll"> Select All
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Fishing Pole"> Fishing Pole
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Stratholme"> Stratholme
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Mace"> Mace
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Sword"> Sword
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Axe"> Axe
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Polearm"> Polearm
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Staff"> Staff
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Dagger"> Dagger
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Bow"> Bow
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Gun"> Gun
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Warglaive"> Warglaive
                    </label>
                    <br />
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Cooking"> Cooking
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Misc"> Misc
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Thrown"> Thrown
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Crossbow"> Crossbow
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Wand"> Wand
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Mining"> Mining
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Skinning"> Skinning
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Herbalism"> Herbalism
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="The Anglers"> The Anglers
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Engineering"> Engineering
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="Fist Weapon"> Fist Weapon
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="This Item Begins a Quest">
                        This Item Begins a Quest
                    </label>
                    <label>
                        <input type="checkbox" class="filterByWeaponType" data-weapon-type="The Eye"> The Eye
                    </label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div id="heatmap"></div>
            </div>
        </div>
    </div>
    <div id="tooltip" class="tooltip" style="opacity: 0;"></div>

    
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script>
        
        d3.json('heatmapData.json').then(function (data) {
            data.sort(function (a, b) {
                return a.itemLevel - b.itemLevel;
            });

            var margin = {top: 120, right: 120, bottom: 120, left: 120},
                width = 2000 - margin.left - margin.right,
                height = 2000 - margin.top - margin.bottom;

            
            var svg = d3.select("#heatmap")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            
            svg.append("text")
                .attr("x", width / 2)
                .attr("y", height + margin.top / 2)
                .style("text-anchor", "middle")
                .attr("class", "axis-label")
                .attr("fill", "white")
                .text("Item Type");

            
            svg.append("text")
                .attr("transform", "rotate(-90)")
                .attr("x", -height / 2)
                .attr("y", -margin.left / 2)
                .style("text-anchor", "middle")
                .attr("class", "axis-label")
                .attr("fill", "white")
                .text("Item Level");

            
            var x = d3.scaleBand()
                .range([0, width])
                .domain(data.map(function (d) {return d.type;}))
                .padding(0.05);

            svg.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x));

            
            var y = d3.scaleBand()
                .range([height, 0])
                .domain(data.map(function (d) {return d.itemLevel;}))
                .padding(0.2);

            svg.append("g")
                .call(d3.axisLeft(y));

            
            var customColor = d3.scaleSequential(d3.interpolateRdBu)
                .domain([0, d3.max(data, function (d) {return d.dps;})]);

            
            var cells = svg.selectAll()
                .data(data)
                .enter()
                .append("rect")
                .attr("x", function (d) {return x(d.type);})
                .attr("y", function (d) {return y(d.itemLevel);})
                .attr("width", x.bandwidth())
                .attr("height", y.bandwidth())
                .style("fill", function (d) {return customColor(d.dps);})
                .attr("class", "heatmap-cell")
                .on("mouseover", function (event, d) {
                    
                    d3.select("#tooltip")
                        .style("opacity", 1)
                        .html(`Type: ${d.type}<br>Item Level: ${d.itemLevel}<br>DPS: ${d.dps}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 20) + "px");
                })
                .on("mouseout", function () {
                    
                    d3.select("#tooltip")
                        .style("opacity", 0);
                });

            
            var checkboxes = document.querySelectorAll(".filterByWeaponType");
            checkboxes.forEach(function (checkbox) {
                checkbox.addEventListener("change", function () {
                    var selectedTypes = Array.from(checkboxes)
                        .filter(function (cb) {
                            return cb.checked;
                        })
                        .map(function (cb) {
                            return cb.getAttribute("data-weapon-type");
                        });

                    
                    var filteredData = data.filter(function (d) {
                        return selectedTypes.includes(d.type);
                    });

                    
                    cells.data(filteredData)
                        .exit().remove()
                        .enter().append("rect")
                        .merge(cells)
                        .attr("x", function (d) {return x(d.type);});

                    
                    cells.transition()
                        .duration(1000)
                        .attr("y", function (d) {return y(d.itemLevel);})
                        .style("fill", function (d) {return customColor(d.dps);});
                });
            });

            
            var selectAllCheckbox = document.getElementById("selectAll");
            selectAllCheckbox.addEventListener("change", function () {
                checkboxes.forEach(function (checkbox) {
                    checkbox.checked = selectAllCheckbox.checked;
                });
                updateHeatmap();
            });

            
            function updateHeatmap() {
                var selectedTypes = Array.from(checkboxes)
                    .filter(function (cb) {
                        return cb.checked;
                    })
                    .map(function (cb) {
                        return cb.getAttribute("data-weapon-type");
                    });

                
                var filteredData = selectAllCheckbox.checked ? data : data.filter(function (d) {
                    return selectedTypes.includes(d.type);
                });

                
                cells.data(filteredData)
                    .exit().remove()
                    .enter().append("rect")
                    .merge(cells)
                    .attr("x", function (d) {return x(d.type);});

                
                cells.transition()
                    .duration(1000)
                    .attr("y", function (d) {return y(d.itemLevel);})
                    .style("fill", function (d) {return customColor(d.dps);});
            }

        });
    </script>
</body>

</html>